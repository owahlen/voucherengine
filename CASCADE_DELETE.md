# Voucherify â€“ Cascade Delete Behavior

This document describes the **cascade-delete behavior for the main Voucherify objects**, focusing on what happens **when that specific object is deleted** (not when something else referencing it is deleted).

---

## High-level rule (important)

> **Voucherify cascades *downward* to dependent objects, but never *upward* or *sideways*.**

- Deleting a **parent** removes its **children**
- Deleting a **child** never deletes its **parent**
- Shared / global objects are never auto-deleted

---

## Cascade behavior by object type

### ğŸ§¾ Voucher (single code)

**DELETE** `/v1/vouchers/{code}`

**Cascade effects**

âœ… Deleted automatically  
- Publications referencing this voucher  
- Redemption records for this voucher  
- Validation history for this voucher  

âŒ Not deleted  
- Campaign  
- Customer  
- Order  
- Product / SKU  

**Notes**
- Other vouchers in the same campaign are unaffected
- Safe for revoking a single leaked or abused code

---

### ğŸ“£ Campaign

**DELETE** `/v1/campaigns/{campaign_name}`

**Cascade effects**

âœ… Deleted automatically  
- All vouchers generated by the campaign  
- All publications of those vouchers  
- All redemption & validation records  

âŒ Not deleted  
- Customers  
- Orders  
- Products / SKUs  
- Segments  

**Notes**
- All issued codes become immediately invalid
- This is a hard delete and is not reversible

---

### ğŸ‘¤ Customer

**DELETE** `/v1/customers/{customer_id}`

**Cascade effects**

âœ… Deleted automatically  
- Publications linked to this customer  

âŒ Not deleted  
- Vouchers (codes remain valid)  
- Campaigns  
- Redemptions  
- Orders  

**Notes**
- Voucher codes previously issued to the customer still exist
- Those vouchers become unassigned, but usable unless restricted

---

### ğŸ§¾ Publication

**DELETE** `/v1/publications/{publication_id}`

**Cascade effects**

âŒ Nothing else is deleted  

**Notes**
- Voucher still exists and remains valid
- Customer still exists
- This is essentially an unlink operation

---

### ğŸ’³ Redemption

**DELETE** âŒ (not supported)

**Behavior**
- Redemptions are immutable audit records
- They can only disappear indirectly via:
  - Voucher deletion
  - Campaign deletion

---

### ğŸ›’ Order

**DELETE** `/v1/orders/{order_id}`

**Cascade effects**

âŒ Nothing else is deleted  

**Notes**
- Vouchers redeemed in that order stay redeemed
- Orders are not owners of vouchers

---

### ğŸ“¦ Product / SKU

**DELETE** `/v1/products/{id}` or `/v1/skus/{id}`

**Cascade effects**

âœ… Deleting a product deletes its SKUs  
âŒ Deleting a SKU does not delete its product  

**Notes**
- Vouchers that reference the product may fail validation afterward
- Historical redemptions remain intact

---

## Summary table

| Deleted object | Cascades to | Does NOT cascade to |
|---------------|-----------|---------------------|
| Campaign | Vouchers, Publications, Redemptions | Customers, Orders |
| Voucher | Publications, Redemptions | Campaign, Customer |
| Customer | Publications | Vouchers |
| Publication | â€” | Everything |
| Redemption | â€” (immutable) | Everything |
| Order | â€” | Everything |
| Product | SKUs | Orders, Vouchers |
| SKU | â€” | Product, Orders, Vouchers |

---

## Practical guidance

### When to delete a voucher
- Single code leaked
- Manual revocation
- Support intervention

### When to delete a campaign
- Test cleanup
- Kill switch (invalidate all issued codes)
- End-of-life cleanup after grace period

### When *not* to delete
- If you only want to stop issuance â†’ deactivate the campaign
- If you need auditability â†’ never delete redemptions

---

_End of document_
